<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Web Test</title>

    <!-- favicon -->
    <link rel="shortcut icon" type="image/png" href="../assets/fox.png"/>

    <!-- custom css -->
    <link rel="stylesheet" type="text/css" href="../css/web.css">

    <!-- jquery 3.6.0 -->
    <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js'
        integrity='sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ=='
        crossorigin='anonymous'></script>

    <!-- bootstrap 5.1.3 -->
    <link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.1.3/css/bootstrap.min.css'
        integrity='sha512-GQGU0fMMi238uA+a/bdWJfpUGKUkBdgfFdgBm72SUQ6BeyWjoY/ton0tEjH+OSH9iP4Dfh+7HM0I9f5eR0L/4w=='
        crossorigin='anonymous' />

    <!-- custom js  -->
    <script type="text/javascript" src="../js/web.js"></script>

    <!-- vConsole -->
    <script src="https://cdn.bootcdn.net/ajax/libs/vConsole/3.14.5/vconsole.min.js"></script>
    <!-- vConsole Init -->
    <script type='text/javascript'>
        var vConsole = new VConsole();
    </script>

</head>

<body class="row">

    <!-- 方法集合 -->
    <div class="col-md-6">

        <!-- 偵測MetaMask -->
        <div class="group">
            <button class="btn btn-primary" onclick="IsMetaMaskInstalled(true)">偵測MetaMask</button>

            <div>
                <label class="key" for="ethereum_installed">是否有導入以太坊套件:</label>
                <label class="val" id="ethereum_installed"></label>
                <div class="desc">
                    <span>
                        以太坊JavaScript API由EIP-1193指定
                        <a href="https://eips.ethereum.org/EIPS/eip-1193" target="blank">[EIP-1193]</a>
                    </span>
                </div>
            </div>

            <div>
                <label class="key" for="ethereum_connected">是否連線:</label>
                <label class="val" id="ethereum_connected"></label>
                <div class="desc">
                    <span>
                        請注意此值與錢包無關, 僅代表是否可以向當前鏈發出RPC請求.
                        <br/>
                        另外若未連接至當前鏈, 則需要重新整理頁面才能建立連接,
                        <br/>
                        若RPC請求(Promise)因任何原因失敗, 都會返回eth-rpc-error.
                        <br/>
                        有關完整的eth-rpc-error請參閱
                        <a href="https://eips.ethereum.org/EIPS/eip-1193" target="blank">[EIP-1193#provider-errors]</a>
                        <a href="https://eips.ethereum.org/EIPS/eip-1474#error-codes" target="blank">[EIP-1474#error-codes]</a>
                    </span>
                </div>
            </div>

            <div>
                <label class="key" for="metamask_ismetamask">是否安裝MetaMask:</label>
                <label class="val" id="metamask_ismetamask"></label>
                <div class="desc">
                    <span>
                        區分當前瀏覽器為MetaMask或其他兼容以太坊的瀏覽器
                        <a href="https://browsertouse.com/blog/5098/best-web-3-0-browsers/" target="blank">[Web 3.0 Browser]</a>
                        <a href="https://brave.com/zh/wallet/" target="blank">[Brave Wallet]</a>
                        <br>
                        此欄位也可能被非MetaMask提供者所設定, 在使用上需再注意
                    </span>
                </div>
            </div>

            <div>
                <label class="key" for="metamask_network">
                    當前網路:
                </label>
                <label class="val" id="metamask_network"></label>
                <div class="desc">
                    <span>
                        所有鏈可以參考
                        <a href="https://chainlist.org/" target="blank">[Chainlists]</a>
                        <br>
                        官方文件上表明若當前頁面所連結的鏈網路變更時, 強烈建議重新整理頁面
                    </span>
                </div>
            </div>
        </div>

        <!-- 開啟錢包 -->
        <div class="group">
            <button class="btn btn-primary" onclick="ConnToMetaMask()">登入錢包</button>

            <div>
                <label class="key" for="metamask_address">已連線的錢包地址: </label>
                <label class="val" id="metamask_address"></label>
            </div>
        </div>

        <!-- 取得餘額 -->
        <div class="group">
            <button class="btn btn-primary" onclick="GetBalance()">取得餘額</button>
            
            <div>
                <label class="key" for="metamask_balance">當前餘額: </label>
                <label class="val" id="metamask_balance"></label>
            </div>
        </div>

        <!-- 連線指定網路 -->
        <div class="group">
            <button class="btn btn-primary" onclick="ConnCustomNetwork()">連線指定網路</button>

            <div>
                <label class="key" for="metamask_switch_network">欲連線至網路Kovan(42)</label>
                <label class="val" id="metamask_switch_network"></label>
            </div>
        </div>

        <!-- 新增並連線指定網路 -->
        <div class="group">
            <button class="btn btn-primary" onclick="AddCustomNetwork()">新增並連線指定網路</button>

            <div>
                <label class="key" for="metamask_add_network">欲新增並連線至Polygon(137)</label>
                <label class="val" id="metamask_add_network"></label>
            </div>
        </div>

        <!-- 新增檢視的資產 -->
        <div class="group">
            <button class="btn btn-primary" onclick="AddAsset()">新增檢視的資產</button>

            <div>
                <label class="key" for="metamask_add_asset">在錢包中追蹤新的Token: <a href="https://polygonscan.com/token/0xc2132d05d31c914a87c6611c10748aeb04b58e8f">Polygon USDT</a></label>
                <label class="val" id="metamask_add_asset"></label>
            </div>
        </div>

        <!-- 簽名 -->
        <div class="group">
            <button class="btn btn-primary" onclick="Sign()">簽名</button>

            <input type="text" class="form-control" id="sign_message" placeholder="請輸入欲簽名的字串">

            <div>
                <label class="key" for="sign_result">簽名結果: </label>
                <label class="val" id="sign_result"></label>
            </div>
        </div>

        <!-- 認證簽名 -->
        <div class="group">
            <button class="btn btn-primary" onclick="VerifySign()">驗證簽名</button>

            <input type="text" class="form-control" id="verify_sign_message" placeholder="請輸入欲驗證的字串">

            <div>
                <label class="key" for="verify_result">驗證結果: </label>
                <label class="val" id="verify_result"></label>
            </div>
        </div>

        <!-- 送出交易 -->
        <div class="group">
            <button type="submit" class="btn btn-primary" onclick="SendTrans()">送出交易</button>

            <input type="text" class="form-control" id="send_address" placeholder="請輸入錢包地址">

            <label class="key">交易所傳遞的參數
                <a href="https://docs.metamask.io/guide/sending-transactions.html#example" target="blank">[說明]</a>
            </label>
            <table class="table">
                <thead>
                    <tr>
                        <th scope="col">欄位名稱</th>
                        <th scope="col">當前值</th>
                        <th scope="col">必填選項</th>
                        <th scope="col">備註</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <th scope="row">nonce</th>
                        <td>0x00</td>
                        <td>ignore</td>
                        <td>區塊鏈交易所計算的隨機數</td>
                    </tr>
                    <tr>
                        <th scope="row">gasPrice</th>
                        <td></td>
                        <td>option</td>
                        <td>Gas Price</td>
                    </tr>
                    <tr>
                        <th scope="row">gas</th>
                        <td></td>
                        <td>option</td>
                        <td>Gas Limit</td>
                    </tr>
                    <tr>
                        <th scope="row">from</th>
                        <td id="send_from"></td>
                        <td>required</td>
                        <td>當前用戶錢包地址, 十六進制編碼的以太坊地址</td>
                    </tr>
                    <tr>
                        <th scope="row">to</th>
                        <td id="send_to"></td>
                        <td>semi-option</td>
                        <td>欲進行交易的錢包或合約地址, 十六進制編碼的以太坊地址, 與某些合約互動時此欄位為選填</td>
                    </tr>
                    <tr>
                        <th scope="row">value</th>
                        <td>2386F26FC10000</td>
                        <td>option</td>
                        <td>貨幣的十六進制編碼值, 當前傳遞10000000000000000wei=0.01ETH</td>
                    </tr>
                    <tr>
                        <th scope="row">data</th>
                        <td></td>
                        <td>semi-option</td>
                        <td>創建智能合約時為必填, 另還可指定合約方法及參數</td>
                    </tr>
                    <tr>
                        <th scope="row">chainId</th>
                        <td>0x00</td>
                        <td>currently-ignore</td>
                        <td>當前無用, 會選擇用戶當前的鏈網路進行交易, 但未來多鏈時有用</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- 測試 -->
        <div class="group">
            <button class="btn btn-danger" onclick="Test()">測試</button>
        </div>


    </div>

    <!-- Log List -->
    <div class="container col-md-6">
        <div class="log row" id="event-log">

        </div>
    </div>
</body>

</html>